import*as e from"@wordpress/interactivity";var t={d:(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const n=(M={getContext:()=>e.getContext,getElement:()=>e.getElement,store:()=>e.store,withScope:()=>e.withScope},h={},t.d(h,M),h),o=300,i=2,s=200,l=400,c=.75,u="rgba(255, 255, 255, 0.75)",a=".wp-block-ollie-mega-menu__menu-container",r=".wp-block-navigation",d=".wp-block-navigation__responsive-container",p=e=>e.querySelector(a),m=(e,t)=>e.classList.contains({custom:"menu-width-custom",content:"menu-width-content",wide:"menu-width-wide",full:"menu-width-full"}[t]),{state:f,actions:g}=(0,n.store)("ollie/mega-menu",{state:{get isMenuOpen(){return Object.values(f.menuOpenedBy).filter(Boolean).length>0},get menuOpenedBy(){return(0,n.getContext)().menuOpenedBy},get isDesktop(){return window.innerWidth>=600},hoverTimeout:null,get dynamicHoverDelay(){const e=((0,n.getContext)().topSpacing||0)*i;return o+e}},actions:{closeAllMenus(){g.closeMenu("click"),g.closeMenu("focus"),g.closeMenu("hover")},applyMobileBackgroundColor(e){if(!f.isDesktop&&f.isMenuOpen){const i=(e=>e.closest(d))(e);if(i){const s=(e=>{if(!e||"transparent"===e||"rgba(0, 0, 0, 0)"===e)return null;const t=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)/);if(t){const[,e,n,o,i]=t;return{r:e,g:n,b:o,a:i||1}}return null})(window.getComputedStyle(i).backgroundColor);e.style.backgroundColor=s?(t=s.r,n=s.g,o=s.b,`rgba(${t}, ${n}, ${o}, ${c})`):u}}else e.style.backgroundColor="";var t,n,o},applyTopSpacing(e){const t=e.dataset.topSpacing;t&&parseInt(t)>0&&f.isDesktop?e.style.top=`${t}px`:f.isDesktop||(e.style.top="")},applyMenuWidth(e){if(m(e,"custom")){const t=e.dataset.customWidth;t&&parseInt(t)>0&&(e.style.width=`${t}px`,e.style.maxWidth=`${t}px`)}else(m(e,"content")||m(e,"wide")||m(e,"full"))&&(e.style.width="",e.style.maxWidth="")},determineJustification:(e,t)=>e.classList.contains("menu-justified-center")?"center":e.classList.contains("menu-justified-right")?"right":e.classList.contains("menu-justified-left")?"left":t.classList.contains("items-justified-center")||t.classList.contains("items-justified-space-between")?"center":t.classList.contains("items-justified-right")?"right":"left",getMenuMeasurements(e,t){const n=window.innerWidth;let o=e.offsetWidth;return m(e,"custom")&&e.dataset.customWidth&&(o=parseInt(e.dataset.customWidth)),{windowSpace:n,originalMenuWidth:o,menuRect:e.getBoundingClientRect(),navBlockRect:t.getBoundingClientRect(),leftOffset:t.getBoundingClientRect().left,leftSpace:(n-o)/2}},adjustMegaMenu(){const{ref:e}=(0,n.getElement)(),t=p(e);if(!t)return;const o=(e=>e.closest(r))(t);if(!o)return;g.applyTopSpacing(t),g.applyMobileBackgroundColor(t),g.applyMenuWidth(t);const i=g.determineJustification(t,o),s=g.getMenuMeasurements(t,o);g.applyJustificationPositioning(t,i,s.windowSpace,s.originalMenuWidth,s.menuRect,s.leftOffset,s.leftSpace,s.navBlockRect)},applyJustificationPositioning(e,t,n,o,i){const c=s;if(o>n){const t=Math.max(n,c);e.style.width=`${t}px`,o=t}if(m(e,"wide")||m(e,"full")){if("center"===t){const t=n/2-o/2-i.left,s=parseFloat(e.style.left||0)+t;e.style.left=`${s}px`}}else if("center"===t&&m(e,"custom")&&parseInt(e.dataset.customWidth)&&(e.style.left=`calc( ( -1 * ${o}px / 2 ) + 50% )`),m(e,"content")||m(e,"custom")){const i=e.getBoundingClientRect(),c=i.left,u=i.right;if(c<0||u>n)if("center"===t){let t=0;if(c<0?t=Math.abs(c):u>n&&(t=-(u-n)),m(e,"custom"))e.style.left=`calc( ( -1 * ${o}px / 2 ) + 50% + ${t}px )`;else{const n=parseFloat(e.style.left||window.getComputedStyle(e).left||0);e.style.left=`${n+t}px`}}else{let i=o,a=!1;if(c<0){const e=Math.abs(c);i=Math.min(i,o-e)}if(u>n){const e=u-n;i=Math.min(i,o-e)}if(a=i<l,a&&"true"!==e.dataset.justificationSwapped){const n="left"===t?"right":"left";return e.classList.remove("menu-justified-left","menu-justified-right","menu-justified-center"),e.classList.add(`menu-justified-${n}`),e.dataset.justificationSwapped="true",e.style.width="",e.style.left="",e.style.maxWidth="",g.adjustMegaMenu()}if(!a){const t=Math.max(i,s);e.style.width=`${t}px`}}}},handleResize(){const{ref:e}=(0,n.getElement)(),t=p(e);t&&(g.clearHoverTimeout(),!f.isDesktop&&f.menuOpenedBy.hover&&g.closeMenu("hover"),delete t.dataset.justificationSwapped,g.adjustMegaMenu(),f.isMenuOpen&&g.applyMobileBackgroundColor(t))},toggleMenuOnClick(){const e=(0,n.getContext)(),{ref:t}=(0,n.getElement)();window.document.activeElement!==t&&t.focus(),f.menuOpenedBy.click||f.menuOpenedBy.focus?(g.closeMenu("click"),g.closeMenu("focus")):(e.previousFocus=t,g.openMenu("click"))},closeMenuOnClick(){g.closeMenu("click"),g.closeMenu("focus")},clearHoverTimeout(){f.hoverTimeout&&(clearTimeout(f.hoverTimeout),f.hoverTimeout=null)},setHoverTimeout(e,t){g.clearHoverTimeout(),f.hoverTimeout=setTimeout((0,n.withScope)(e),t)},shouldActivateHover:()=>(0,n.getContext)().showOnHover&&f.isDesktop,handleMouseEnter(){g.shouldActivateHover()&&g.setHoverTimeout((()=>{f.menuOpenedBy.click||g.openMenu("hover")}),o)},handleMouseLeave(){g.shouldActivateHover()&&g.setHoverTimeout((()=>{g.closeMenu("hover")}),f.dynamicHoverDelay)},handleMenuMouseEnter(){g.shouldActivateHover()&&g.clearHoverTimeout()},handleMenuMouseLeave(){g.shouldActivateHover()&&g.setHoverTimeout((()=>{g.closeMenu("hover")}),o)},handleMenuKeydown(e){f.menuOpenedBy.click&&"Escape"===e?.key&&(g.closeMenu("click"),g.closeMenu("focus"))},handleMenuFocusout(e){const t=(0,n.getContext)(),o=t.megaMenu?.querySelector(".wp-block-ollie-mega-menu__menu-container");(null===e.relatedTarget||!o?.contains(e.relatedTarget)&&e.target!==window.document.activeElement)&&g.closeAllMenus()},openMenu(e="click"){f.menuOpenedBy[e]=!0},closeMenu(e="click"){const t=(0,n.getContext)();if(f.menuOpenedBy[e]=!1,!f.isMenuOpen){if(t.megaMenu?.contains(window.document.activeElement)&&t.previousFocus?.focus(),t.previousFocus=null,t.megaMenu){const e=p(t.megaMenu);e&&delete e.dataset.justificationSwapped}t.megaMenu=null}}},callbacks:{initMenu(){const e=(0,n.getContext)(),{ref:t}=(0,n.getElement)();if(f.isMenuOpen){e.megaMenu=t;const n=p(t);n&&g.applyMobileBackgroundColor(n)}},initMenuLayout(){g.adjustMegaMenu()}}});var M,h;